function z = RK4(A,x,stepsize,t0,t1)
%Fourth order non adaptive Runge Kutta method for the solution of y' = A*y
n = length(x);
t = t0;
z = x;
a = [0 0 0; 5/24 1/3 -1/24; 1/6 2/3 1/6];
a = kron(a,A);
b = [1/6;2/3;1/6];
A = kron(eye(3),A);
while t<t1
    t = t + stepsize;
    k_1 = A*x;
    k_2 = A*(x + 0.5*k_1);
    k_3 = A*(y(i)+0.5*h*k_2);
    k_4 = A*(y(i)+k_3*h);
    x = x + (1/6)*(k_1+2*k_2+2*k_3+k_4)*stepsize;  % main equation
end